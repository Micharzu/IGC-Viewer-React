(this["webpackJsonpigc-viewer-react"]=this["webpackJsonpigc-viewer-react"]||[]).push([[0],{171:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(11),l=a.n(i),r=(a(54),a(7)),o=a.n(r),s=a(18),u=a(1),f=a(48),h=Object(n.createContext)(),m=function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),i=a[0],l=a[1],r=Object(n.useState)(),m=Object(u.a)(r,2),g=m[0],b=m[1],p=Object(n.useState)({}),d=Object(u.a)(p,2),O=d[0],E=d[1],j=Object(n.useState)(),D=Object(u.a)(j,2),v=D[0],I=D[1],T=Object(n.useState)(),S=Object(u.a)(T,2),x=S[0],k=S[1];Object(n.useEffect)((function(){P(),y()}),[i]),Object(n.useEffect)((function(){C()}),[g]);var P=function(){console.log("Clearing Data!"),b(),E({})},y=function(){i&&b(i.split("\n"))},C=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=6;break}return e.next=3,N();case 3:return e.next=5,M();case 5:L();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(e){return 3600*parseInt(e.slice(0,2))+60*parseInt(e.slice(2,4))+parseInt(e.slice(4,6))},L=function(){var e=function(){var e=w(O.flightData[0].slice(0,6));return w(O.flightData[O.flightData.length-1].slice(0,6))-e}(),t=Math.trunc(e/3600),a=e%3600,n=Math.trunc(a/60),c=n>=10?"":0,i=(a%=60)>=10?"":0,l="".concat(t,":").concat(c).concat(n,":").concat(i).concat(a),r=(O.FRID,O.DTE,O.Sec,O.PLTPILOT,O.flightData,Object(f.a)(O,["FRID","DTE","Sec","PLTPILOT","flightData"]));r.flightTime={text:"\u0141\u0105czny czas lotu",value:l};var o=function(e){return"".concat(e.slice(0,2),":").concat(e.slice(2,4),":").concat(e.slice(4,6))},s=O.flightData[0],u=O.flightData[O.flightData.length-1],h=o(s),m=o(u);r.flightStart={text:"Odlot",value:h},r.flightFinnish={text:"L\u0105dowanie",value:m};var g=function(e){return e.slice(6,8)+"\xb0 "+e.slice(8,10)+"."+e.slice(10,13)+"'"+e.slice(13,14)+" "+(e.slice(14,17)+"\xb0 "+e.slice(17,19)+"."+e.slice(19,22)+"'"+e.slice(22,23))};r.startingPosition={text:"Miejsce odlotu",value:g(s)},r.finishingPosition={text:"Miejsce l\u0105dowania",value:g(u)},I(r);var b="".concat(O.DTE.slice(0,2),"/").concat(O.DTE.slice(2,4),"/20").concat(O.DTE.slice(4)),p=O.flightData.filter((function(e,t){return t%6===0}));p[p.length-1]!==O.flightData[O.flightData.length-1]&&p.push(O.flightData[O.flightData.length-1]);var d=function(t){t.FRID,t.Sec;var a=t.PLTPILOT,n=t.flightData;return{PLTPILOT:a,flightDate:b,flightData:n,filteredData:p,flightTimeInSecs:e}}(O);k(d)},N=function(){"object"===typeof g&&(O.flightData=[],g.forEach((function(e,t){switch(0===t&&(O.FRID=e),e.charAt(0)){case"B":O.flightData.push(e.slice(1));break;case"G":O.Sec=e.slice(1);break;case"H":var a=e.indexOf(":"),n=(e.indexOf(": ")===a?1:0)+1;switch(e.slice(2,a)){case"GTYGLIDERTYPE":O.GTYGLIDERTYPE={text:"Typ lotni",value:e.slice(a+n)};break;case"CCLCOMPETITION CLASS":O.CCLCOMPETITION_CLASS={text:"Typ zawod\xf3w",value:e.slice(a+n)};break;case"TZNTIMEZONE":O.TZNTIMEZONE={text:"Strefa czasowa",value:e.slice(a+n)};break;default:if(e.includes("DTE")){if(-1!==a){O.DTE=e.slice(a+n,a+n+6);break}O.DTE=e.slice(5,11);break}if(e.includes("PLTPILOT")){O.PLTPILOT=e.slice(a+n);break}}}})))},M=function(){try{if("A"!==O.FRID.charAt(0))throw new Error("IGC file must contain an ID!");if(!O.Sec)throw new Error("IGC file must contain a security code!")}catch(e){console.log("An error has occured: "+e.message)}};return c.a.createElement(h.Provider,{value:{targetFile:[i,l],mContentObject:[x,k],aContentObject:[v,I]}},e.children)},g=(a(56),function(){var e=Object(n.useContext)(h).targetFile,t=Object(u.a)(e,2),a=(t[0],t[1]),i=Object(n.useState)(),l=Object(u.a)(i,2),r=l[0],f=l[1],m=Object(n.useState)(""),g=Object(u.a)(m,2),b=g[0],p=g[1];Object(n.useEffect)((function(){r&&".igc"===r.slice(-4)&&d()}),[r]);var d=function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://cors-anywhere.herokuapp.com/"+r);case 2:return t=e.sent,e.t0=a,e.next=6,t.text();case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log(b),f(b),p("")},className:"urlInputForm"},c.a.createElement("h3",null,"Wklej tutaj URL wybranego pliku .igc"),c.a.createElement("div",{className:"urlInputSection"},c.a.createElement("input",{className:"urlInput",type:"url",value:b,onChange:function(e){p(e.target.value)}}),c.a.createElement("button",{className:"urlInputButton",type:"submit"},"Wybierz plik"))))}),b=(a(57),a(58),function(e){var t=["componentRecord",e.classAdded].join(" ");return c.a.createElement("div",{className:t},c.a.createElement("h3",null,e.text),c.a.createElement("h3",null,e.value))}),p=a(30),d=a(47),O={position:"relative",width:"100%",height:"100%"},E=function(e){e.flightData[0],e.flightData[e.flightData.length-1];var t,a=Object(n.useState)([]),i=Object(u.a)(a,2),l=i[0],r=i[1];Object(n.useEffect)((function(){s()}),[e.flightData]);var o=[],s=(function(e){for(var t=[5,10,15,30,60],a=0;a<t.length-1;a++)if(e/8<60*t[a])return t[a]}(e.flightTimeInSecs),function(){e.flightData.forEach((function(e,a){var n,c=parseInt(e.slice(29,34)),i=(n=e.slice(0,6),3600*parseInt(n.slice(0,2))+60*parseInt(n.slice(2,4))+parseInt(n.slice(4,6)));0===a&&(t=i);var l=i-t,r={x:Math.round(l/60*10)/10,y:c};o.push(r)})),r(o)}),f=Object(n.useState)({data:{datasets:[{data:l,showLine:!0,borderColor:"rgba(230, 65, 47, 0.9)",pointBackgroundColor:"lightblue",pointRadius:0,pointHitRadius:5}]},options:{title:{display:!0,text:"Wysoko\u015b\u0107 npm podczas lotu"},legend:{display:!1},responsive:!0,scales:{yAxes:[{scaleLabel:{labelString:"Wysoko\u015b\u0107 (m)",display:!0}}],xAxes:[{scaleLabel:{labelString:"Czas lotu (min)",display:!0}}]}}}),h=Object(u.a)(f,2),m=h[0],g=h[1];return Object(n.useEffect)((function(){g((function(e){return Object(p.a)(Object(p.a)({},e),{},{data:{datasets:[{data:l,showLine:!0,borderColor:"rgba(230, 65, 47, 0.9)",pointBackgroundColor:"lightblue",pointRadius:0,pointHitRadius:5}]}})}))}),[l]),c.a.createElement("div",{className:"graphInner",style:O},c.a.createElement(d.Scatter,{data:m.data,options:m.options}))},j=a(8),D={position:"relative",width:"100%",height:"100%"},v=Object(j.GoogleApiWrapper)({apiKey:"AIzaSyDrqc5R65cKDZMVxzoN172YnlLCGKiHNM4"})((function(e){var t=Object(n.useState)({}),a=Object(u.a)(t,2),i=a[0],l=a[1],r=Object(n.useState)([]),o=Object(u.a)(r,2),s=o[0],f=o[1];Object(n.useEffect)((function(){var t=e.flightData[0],a=e.flightData[e.flightData.length-1],n=m(t),c=m(a);l({startPositionDD:n,finnishPositionDD:c,mapPositionDD:{lat:(n.lat+c.lat)/2,lng:(n.lng+c.lng)/2}});var i=e.flightData.map((function(e){return m(e)}));f(i)}),[e.flightData]);var h=function(e,t){var a=t.slice(e,e+2)+"."+t.slice(e+2,e+5);"0"===a[0]&&(a=a.slice(1));var n=1;"S"!==t.slice(e+5)&&"W"!==t.slice(e+5)||(n=-1);var c=parseFloat(a)/60,i=parseFloat(t.slice(0,e));return Number((i+c).toFixed(6))*n},m=function(e){return{lat:h(2,e.slice(6,14)),lng:h(3,e.slice(14,23))}};return i.mapPositionDD?c.a.createElement("div",{className:"mapInner"},c.a.createElement(j.Map,{google:e.google,zoom:8,style:D,initialCenter:i.mapPositionDD,center:i.mapPositionDD},c.a.createElement(j.Marker,{label:{text:"Pocz\u0105tek",fontSize:"16px",fontWeight:"700",color:"rgb(30, 30, 30)"},position:i.startPositionDD}),c.a.createElement(j.Marker,{label:{text:"Koniec",fontSize:"16px",fontWeight:"700",color:"rgb(30, 30, 30)"},position:i.finnishPositionDD}),c.a.createElement(j.Polyline,{path:s,geodesic:!0,options:{strokeColor:"rgba(230, 65, 47, 0.9)",strokeOpacity:.75,strokeWeight:3}}))):c.a.createElement("div",null,c.a.createElement("h3",null,"\u0141adowanie..."))})),I=function(){var e=Object(n.useContext)(h),t=e.mContentObject,a=e.aContentObject,i=Object(u.a)(t,2),l=i[0],r=(i[1],Object(u.a)(a,2)),o=r[0],s=(r[1],Object(n.useState)(!1)),f=Object(u.a)(s,2),m=f[0],g=f[1],p=Object(n.useState)("Poka\u017c dodatkowe informacje"),d=Object(u.a)(p,2),O=d[0],j=d[1];return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"mainInfo"},c.a.createElement(b,{key:"PLTPILOT",text:"Nazwa Pilota",value:l.PLTPILOT,classAdded:"mainInfo"}),c.a.createElement(b,{key:"flightDate",text:"Data lotu",value:l.flightDate,classAdded:"mainInfo"})),c.a.createElement("button",{className:"toggleBtn",onClick:function(){m?(g(!1),j("Poka\u017c dodatkowe informacje")):(j("Ukryj dodatkowe informacje"),g(!0))}},O),c.a.createElement("div",{className:"additionalInfo"},m&&c.a.createElement(c.a.Fragment,null,Object.entries(o).map((function(e){return c.a.createElement(b,{key:e[0],text:e[1].text,value:e[1].value,classAdded:"additionalInfo"})})),c.a.createElement("div",{className:"features"},c.a.createElement("div",{className:"graph"},c.a.createElement(E,{flightData:l.filteredData,flightTimeInSecs:l.flightTimeInSecs})),c.a.createElement("div",{className:"map"},c.a.createElement(v,{flightData:l.filteredData,flightTimeInSecs:l.flightTimeInSecs}))))))},T=function(){var e=Object(n.useContext)(h),t=e.mContentObject,a=e.aContentObject,i=Object(u.a)(t,2),l=i[0],r=(i[1],Object(u.a)(a,2)),o=r[0],s=(r[1],Object(n.useState)(!1)),f=Object(u.a)(s,2),m=f[0],g=f[1],b=Object(n.useState)(!1),p=Object(u.a)(b,2),d=p[0],O=p[1];return Object(n.useEffect)((function(){l&&g("object"===typeof l)}),[l]),Object(n.useEffect)((function(){o&&O("object"===typeof o)}),[o]),c.a.createElement("div",null,m&&d&&c.a.createElement(I,null))},S=function(){return c.a.createElement(m,null,c.a.createElement("div",{className:"app"},c.a.createElement("div",{className:"title"},c.a.createElement("h2",null,"IGC VIEWER")),c.a.createElement(g,null),c.a.createElement(T,null)))};l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(S,null)),document.getElementById("root"))},49:function(e,t,a){e.exports=a(171)},54:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){}},[[49,1,2]]]);
//# sourceMappingURL=main.7d014a97.chunk.js.map